{{{
  "title": "Platform Specific: Installing the AF CLI Tool on Windows",
  "date": "1-22-2015",
  "author": "Chris Sterling",
  "attachments": [],
  "contentIsHTML": true
}}}

<p>This tutorial based on the steps to install the AF CLI Tool on Windows 7 and 8. Be sure to install the proper 32 or 64 bit version of Ruby and the DevKit.</p>
<ul>
<ul>
<li><a href="#ruby">Install Ruby</a></li>
<li><a href="#devkit">Install Development Kit</a></li>
<li><a href="#af">Install AF Gem</a></li>
<li><a href="#trouble">Troubleshooting Tips </a></li>
</ul>
</ul>
<h3><a name="ruby"></a>Install Ruby</h3>
<p>Download and install <a href="http://rubyinstaller.org/downloads/">Ruby Installer for Windows</a>.The installer already includes RubyGems. We recommend using version 2.1 or older as some users have reported issues with Ruby 2.2 compiling.</p>
<ul>
<ul>
<ol>
<li>In the dialog box select the options to:</li>
<ul>
<li>"Add Ruby executeables to your PATH"</li>
<li>"Associate .rb and .rbw files with this Ruby installation"</li>
</ul>
<li>Check to ensure Ruby is in your PATH:
<pre>echo %PATH%<code> </code></pre>
</li>
<li>If Ruby is not show in your PATH run:
<pre>set PATH=C:\&lt;ruby installed directory&gt;/bin;%PATH%</pre>
</li>
</ol>
</ul>
</ul>
<h3><a name="devkit"></a>Install the Development Kit</h3>
<p>You will also need to download and install the <a href="http://rubyinstaller.org/downloads/">Development Kit</a>, be sure to install the proper version based on your version of Ruby. The steps below and further details can be found on the <a href="https://github.com/oneclick/rubyinstaller/wiki/Development-Kit">Development Kit wiki page</a>.</p>
<ul>
<ul>
<ol>
<li>Left double-click the self-extracting executable (SFX) downloaded from above and choose a directory (without spaces) to install the DevKit artifacts into. For example,<code>C:\DevKit</code>. <strong>NOTE:</strong> the SFX is really a 7-Zip archive with a bit of embedded magic. If you already have <a href="http://7-zip.org/">7-Zip</a> installed, you can simply right-click it and extract its contents as you would a normal 7z archive. In the instructions that follow, the directory that you selected is identified as <code>&lt;DEVKIT_INSTALL_DIR&gt;</code>. <strong>NOTE:</strong> <strong>Do not rename this directory because once you install in Step 6 the path is hardcoded into the Ruby installation</strong>. If you do need to rename the directory re-run Step 2 below with the <code>--force</code> option.</li>
<li>From Step 1 above
<pre>cd &lt;DEVKIT_INSTALL_DIR&gt;</pre>
</li>
<li>Generate the <code>config.yml</code> file to be used next. Your installed Rubies will be listed there (only those installed by a RubyInstaller package are detected at present).
<pre>ruby dk.rb init</pre>
</li>
<li>Edit the generated <code>config.yml</code> file to include installed Rubies not automatically discovered or remove Rubies you do not want to use the DevKit with.</li>
<ul>
<li>Note: Do not omit the dash (-) in front of the PATH in the config.yml file, as in: <code>- C:/Ruby21-x64</code></li>
</ul>
<li>Review the list of Rubies to be enhanced to use the DevKit and verify the changes you made to it are correct.
<pre>ruby dk.rb review</pre>
</li>
<li>DevKit enhance your installed Rubies
<pre>ruby dk.rb install</pre>
</li>
<li>
<ul>
<li>If you use the x64 version of ruby you might get an error saying `Invalid configuration. Please fix ‘config.yml’ and rerun ‘ruby dk.rb install’`. See<a href="http://stackoverflow.com/questions/16523607/cant-get-ruby-devkit-configuration-file-autogenerated-properly">http://stackoverflow.com/questions/16523607/cant-get-ruby-devkit-configuration-file-autogenerated-properly</a></li>
</ul>
</li>
<li>Confirm your Ruby environment is correctly using the DevKit by running
<pre>gem install json --platform=ruby</pre>
. JSON should install correctly and you should see with native extensions in the screen messages. Next confirm that the json gem is working.
<pre>ruby -rubygems -e "require 'json'; puts JSON.load('[42]').inspect"</pre>
</li>
</ol>
</ul>
</ul>
<h3><a name="af"></a>Install AF Gem</h3>
<p>After installing Ruby and the DevKit, be sure you use the <strong>Ruby-enabled command prompt window</strong> when you later install and use <em>af</em>. You access this command prompt from the Windows Start menu (All Programs &gt; Ruby &gt; Start Command Prompt with Ruby) or by searching for Ruby Command Prompt.</p>
<ul>
<ul>
<ul>
<li>
<pre>gem update --system</pre>
</li>
<li>There is an issue with the latest version of escape_utils so first manually install the dependency:
<pre>gem install escape_utils -v 1.0.1</pre>
</li>
<li>
<pre>gem install af</pre>
</li>
<ul>
<li>Depending on the version of Ruby, users may see the warning:<br /> <code>[WARNING] DL is deprecated, please use Fiddle</code> <br />This is not an error, but a warning and can be ignored.</li>
</ul>
</ul>
</ul>
</ul>
<hr />
<h3><a name="trouble"></a>Troubleshooting Tips</h3>
<table>
<tbody>
<tr>
<td>
<p>A small percentage of Windows users have encountered errors while installing RubyGems 1.9.3, and have received messages similar to:</p>
<pre><span class="pln">Makefile:165: *** target pattern contains no `%'. Stop.<br />make failed, exit code 2</span></pre>
<p>We have found that a downgrade to another version of RubyGems have fixed a vast majority of the issues. To accomplish this, simply enter the following in your CLI:</p>
<pre>&gt;gem update --system 1.8.29</pre>
</td>
</tr>
<tr>
<td>
<pre>ERROR: Error installing af:
The 'eventmachine' native gem requires installed build tools.</pre>
<p>Ensure you're using the correct version of the Development Kit from the Ruby installer website as mentioned in the article above.</p>
</td>
</tr>
<tr>
<td>
<pre>*ERROR: While executing gem ... (Gem::RemoteFetcher::FetchError)* <br />* SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: <br />certificate verify failed * </pre>
<p>Try the workaround found here: <a href="https://gist.github.com/luislavena/f064211759ee0f806c88">Ruby Installer SSL Workaround</a>. The .pem file in that post can be found <a href="https://raw.githubusercontent.com/rubygems/rubygems/master/lib/rubygems/ssl_certs/AddTrustExternalCARoot-2048.pem">here</a>.</p>
<p>Try appending the HTTPS version of the RubyGems website to your gem install like so:</p>
<pre>&gt;gem install af --source https://rubygems.org</pre>
<p>If you're still having issues, you can change the default source to the HTTP version of the RubyGems site, but be aware that this is not a secure source for the gem.</p>
<pre>&gt;gem source -r https://rubygems.org
&gt;gem source -a http://rubygems.org
&gt;gem install af</pre>
</td>
</tr>
</tbody>
</table>
<p> </p>
